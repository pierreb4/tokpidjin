def solve_39e1d7f9(S, I):
    return paint(I, mapply(lbind(shift, asobject(crop(I, decrement(subtract(corner(get_arg_rank_f(colorfilter(o_g(I, R5), color(get_nth_t(remove_f(get_nth_t(order(fgpartition(I), height_f), L1), order(fgpartition(I), height_f)), L1))), chain(chain(size, lbind(remove, get_color_rank_t(I, F0)), palette_t), rbind(toobject, I), power(outbox, TWO)), F0), R0), shape_f(get_arg_rank_f(colorfilter(o_g(I, R5), color(get_nth_t(remove_f(get_nth_t(order(fgpartition(I), height_f), L1), order(fgpartition(I), height_f)), L1))), chain(chain(size, lbind(remove, get_color_rank_t(I, F0)), palette_t), rbind(toobject, I), power(outbox, TWO)), F0)))), add(multiply(shape_f(get_arg_rank_f(colorfilter(o_g(I, R5), color(get_nth_t(remove_f(get_nth_t(order(fgpartition(I), height_f), L1), order(fgpartition(I), height_f)), L1))), chain(chain(size, lbind(remove, get_color_rank_t(I, F0)), palette_t), rbind(toobject, I), power(outbox, TWO)), F0)), THREE), TWO_BY_TWO)))), apply(rbind(subtract, increment(shape_f(get_arg_rank_f(colorfilter(o_g(I, R5), color(get_nth_t(remove_f(get_nth_t(order(fgpartition(I), height_f), L1), order(fgpartition(I), height_f)), L1))), chain(chain(size, lbind(remove, get_color_rank_t(I, F0)), palette_t), rbind(toobject, I), power(outbox, TWO)), F0)))), apply(rbind(corner, R0), colorfilter(o_g(I, R5), color(get_nth_t(remove_f(get_nth_t(order(fgpartition(I), height_f), L1), order(fgpartition(I), height_f)), L1)))))))
