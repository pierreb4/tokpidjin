def solve_97a05b5b(S, I):
    return paint(paint(subgrid(get_arg_rank_f(o_g(I, R3), size, F0), I), mapply(fork(mapply, compose(lbind(lbind, shift), normalize), fork(apply, chain(compose(lbind(rbind, subtract), rbind(corner, R0)), fork(combine, compose(lbind(recolor_o, ZERO), rbind(sfilter, compose(flip, matcher(rbind(get_nth_f, F0), TWO)))), rbind(sfilter, matcher(rbind(get_nth_f, F0), TWO))), normalize), fork(sfilter, compose(rbind(sfilter, chain(compose(positive, size), lbind(sfilter, apply(toindices, o_g(switch(subgrid(get_arg_rank_f(o_g(I, R3), size, F0), I), TWO, ZERO), R7))), lbind(lbind, contained))), chain(lbind(occurrences, switch(subgrid(get_arg_rank_f(o_g(I, R3), size, F0), I), TWO, ZERO)), fork(combine, compose(lbind(recolor_o, ZERO), rbind(sfilter, compose(flip, matcher(rbind(get_nth_f, F0), TWO)))), rbind(sfilter, matcher(rbind(get_nth_f, F0), TWO))), normalize)), chain(rbind(compose, compose(chain(size, rbind(get_nth_f, F0), lbind(sfilter, apply(toindices, o_g(switch(subgrid(get_arg_rank_f(o_g(I, R3), size, F0), I), TWO, ZERO), R7)))), lbind(lbind, contained))), lbind(rbind, equality), rbind(colorcount_f, TWO))))), mapply(lbind(rapply, apply(fork(compose, rbind(get_nth_f, F0), rbind(get_nth_f, L1)), product(combine(astuple(rbind(mir_rot_f, R3), rbind(mir_rot_f, R1)), astuple(rbind(mir_rot_f, R0), rbind(mir_rot_f, R2))), combine(astuple(rbind(mir_rot_f, R3), rbind(mir_rot_f, R1)), astuple(rbind(mir_rot_f, R0), rbind(mir_rot_f, R2)))))), sfilter_f(o_g(I, R3), compose(rbind(greater, ONE), numcolors_f))))), mapply(fork(mapply, compose(lbind(lbind, shift), normalize), fork(apply, chain(compose(lbind(rbind, subtract), rbind(corner, R0)), fork(combine, compose(lbind(recolor_o, ZERO), rbind(sfilter, compose(flip, matcher(rbind(get_nth_f, F0), TWO)))), rbind(sfilter, matcher(rbind(get_nth_f, F0), TWO))), normalize), chain(lbind(occurrences, switch(subgrid(get_arg_rank_f(o_g(I, R3), size, F0), I), TWO, ZERO)), fork(combine, compose(lbind(recolor_o, ZERO), rbind(sfilter, compose(flip, matcher(rbind(get_nth_f, F0), TWO)))), rbind(sfilter, matcher(rbind(get_nth_f, F0), TWO))), normalize))), mapply(lbind(rapply, apply(fork(compose, rbind(get_nth_f, F0), rbind(get_nth_f, L1)), product(combine(astuple(rbind(mir_rot_f, R3), rbind(mir_rot_f, R1)), astuple(rbind(mir_rot_f, R0), rbind(mir_rot_f, R2))), combine(astuple(rbind(mir_rot_f, R3), rbind(mir_rot_f, R1)), astuple(rbind(mir_rot_f, R0), rbind(mir_rot_f, R2)))))), sfilter_f(sfilter_f(o_g(I, R3), compose(rbind(greater, ONE), numcolors_f)), chain(flip, rbind(contained, lbind(remove, TWO)(palette_t(mapply(fork(mapply, compose(lbind(lbind, shift), normalize), fork(apply, chain(compose(lbind(rbind, subtract), rbind(corner, R0)), fork(combine, compose(lbind(recolor_o, ZERO), rbind(sfilter, compose(flip, matcher(rbind(get_nth_f, F0), TWO)))), rbind(sfilter, matcher(rbind(get_nth_f, F0), TWO))), normalize), fork(sfilter, compose(rbind(sfilter, chain(compose(positive, size), lbind(sfilter, apply(toindices, o_g(switch(subgrid(get_arg_rank_f(o_g(I, R3), size, F0), I), TWO, ZERO), R7))), lbind(lbind, contained))), chain(lbind(occurrences, switch(subgrid(get_arg_rank_f(o_g(I, R3), size, F0), I), TWO, ZERO)), fork(combine, compose(lbind(recolor_o, ZERO), rbind(sfilter, compose(flip, matcher(rbind(get_nth_f, F0), TWO)))), rbind(sfilter, matcher(rbind(get_nth_f, F0), TWO))), normalize)), chain(rbind(compose, compose(chain(size, rbind(get_nth_f, F0), lbind(sfilter, apply(toindices, o_g(switch(subgrid(get_arg_rank_f(o_g(I, R3), size, F0), I), TWO, ZERO), R7)))), lbind(lbind, contained))), lbind(rbind, equality), rbind(colorcount_f, TWO))))), mapply(lbind(rapply, apply(fork(compose, rbind(get_nth_f, F0), rbind(get_nth_f, L1)), product(combine(astuple(rbind(mir_rot_f, R3), rbind(mir_rot_f, R1)), astuple(rbind(mir_rot_f, R0), rbind(mir_rot_f, R2))), combine(astuple(rbind(mir_rot_f, R3), rbind(mir_rot_f, R1)), astuple(rbind(mir_rot_f, R0), rbind(mir_rot_f, R2)))))), sfilter_f(o_g(I, R3), compose(rbind(greater, ONE), numcolors_f))))))), chain(rbind(get_nth_f, F0), lbind(remove, TWO), palette_f))))))
