def solve_57aa92db(S, I):
    return paint(paint(I, mapply(fork(recolor_o, chain(chain(rbind(get_nth_f, F0), lbind(remove, ZERO), palette_f), rbind(toobject, I), outbox), fork(upscale_f, compose(lbind(shift, normalize_o(get_arg_rank_f(o_g(I, R3), fork(subtract, compose(rbind(get_rank, F0), fork(apply, lbind(lbind, colorcount_f), palette_f)), compose(rbind(get_rank, L1), fork(apply, lbind(lbind, colorcount_f), palette_f))), F0))), fork(subtract, rbind(corner, R0), compose(lbind(multiply, corner(sfilter_f(normalize_o(get_arg_rank_f(o_g(I, R3), fork(subtract, compose(rbind(get_rank, F0), fork(apply, lbind(lbind, colorcount_f), palette_f)), compose(rbind(get_rank, L1), fork(apply, lbind(lbind, colorcount_f), palette_f))), F0)), matcher(rbind(get_nth_f, F0), get_color_rank_f(get_arg_rank_f(o_g(I, R3), fork(subtract, compose(rbind(get_rank, F0), fork(apply, lbind(lbind, colorcount_f), palette_f)), compose(rbind(get_rank, L1), fork(apply, lbind(lbind, colorcount_f), palette_f))), F0), L1))), R0)), width_f))), width_f)), colorfilter(o_g(I, R5), get_color_rank_f(get_arg_rank_f(o_g(I, R3), fork(subtract, compose(rbind(get_rank, F0), fork(apply, lbind(lbind, colorcount_f), palette_f)), compose(rbind(get_rank, L1), fork(apply, lbind(lbind, colorcount_f), palette_f))), F0), L1)))), merge_f(o_g(I, R5)))
