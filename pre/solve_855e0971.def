def solve_855e0971(S, I):
    return branch(positive(size_f(sfilter_f(frontiers(I), hline_o))), identity, rbind(mir_rot_t, R1))(fill(branch(positive(size_f(sfilter_f(frontiers(I), hline_o))), identity, rbind(mir_rot_t, R1))(I), ZERO, mapply(fork(intersection, toindices, fork(shift, chain(lbind(mapply, vfrontier), rbind(f_ofcolor, ZERO), rbind(subgrid, branch(positive(size_f(sfilter_f(frontiers(I), hline_o))), identity, rbind(mir_rot_t, R1))(I))), rbind(corner, R0))), sfilter_f(partition(branch(positive(size_f(sfilter_f(frontiers(I), hline_o))), identity, rbind(mir_rot_t, R1))(I)), compose(flip, matcher(color, ZERO))))))
