def solve(S, I, C):
    return paint(paint(I, mapply(fork(recolor_o, chain(chain(rbind(get_nth_f, F0), lbind(remove, ZERO), palette_f), rbind(toobject, I), outbox), fork(upscale_f, fill(lbind(shift, normalize_o(get_arg_rank_f(astuple(ONE, size_f(sizefilter(colorfilter(rbind(subgrid, I), BLUE), FOUR))), fork(subtract, compose(canvas(BLUE, astuple(ONE, size_f(sizefilter(colorfilter(rbind(subgrid, I), BLUE), FOUR)))), fork(apply, lbind(lbind, colorcount_f), palette_f)), compose(rbind(get_rank, L1), fork(apply, lbind(lbind, colorcount_f), palette_f))), F0))), fork(subtract, chain(rbind(subgrid, I), lbind(extract, get_nth_f(asindices(I)(I, R7), F0)), lbind(compose, matcher(lbind(index, I), ZERO)))(fill(fill(I, CYAN, mapply(lbind(shift, asobject(canvas(GRAY, TWO_BY_TWO))), occurrences(I, asobject(canvas(GRAY, TWO_BY_TWO))))), get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F1)), mapply(lbind(shift, asobject(vconcat(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F0)), astuple(TWO, ONE)), canvas(GRAY, UNITY)))), uppermost_o))), compose(lbind(multiply, corner(sfilter_f(normalize_o(get_arg_rank_f(astuple(ONE, size_f(sizefilter(colorfilter(rbind(subgrid, I), BLUE), FOUR))), fork(subtract, compose(canvas(BLUE, astuple(ONE, size_f(sizefilter(colorfilter(rbind(subgrid, I), BLUE), FOUR)))), fork(apply, lbind(lbind, colorcount_f), palette_f)), compose(rbind(get_rank, L1), fork(apply, lbind(lbind, colorcount_f), palette_f))), F0)), matcher(rbind(get_nth_f, F0), get_color_rank_f(get_arg_rank_f(astuple(ONE, size_f(sizefilter(colorfilter(rbind(subgrid, I), BLUE), FOUR))), fork(subtract, compose(canvas(BLUE, astuple(ONE, size_f(sizefilter(colorfilter(rbind(subgrid, I), BLUE), FOUR)))), fork(apply, lbind(lbind, colorcount_f), palette_f)), compose(rbind(get_rank, L1), fork(apply, lbind(lbind, colorcount_f), palette_f))), F0), L1))), R0)), width_f))), width_f)), colorfilter(mapply(lbind(shift, asobject(mir_rot_t(vconcat(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F0)), astuple(TWO, ONE)), canvas(GRAY, UNITY)), R0))), occurrences(fill(fill(fill(I, CYAN, mapply(lbind(shift, asobject(canvas(GRAY, TWO_BY_TWO))), occurrences(I, asobject(canvas(GRAY, TWO_BY_TWO))))), get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F1)), mapply(lbind(shift, asobject(vconcat(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F0)), astuple(TWO, ONE)), canvas(GRAY, UNITY)))), uppermost_o)), RED, mapply(lbind(shift, asobject(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(first(S)))))()(dedupe(mapply(p_g(apply(second(S)))))()))(F0)), astuple(ONE, THREE)))), occurrences(fill(fill(I, CYAN, mapply(lbind(shift, asobject(canvas(GRAY, TWO_BY_TWO))), occurrences(I, asobject(canvas(GRAY, TWO_BY_TWO))))), get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F1)), mapply(lbind(shift, asobject(vconcat(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F0)), astuple(TWO, ONE)), canvas(GRAY, UNITY)))), uppermost_o)), asobject(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(first(S)))))()(dedupe(mapply(p_g(apply(second(S)))))()))(F0)), astuple(ONE, THREE)))))), asobject(mir_rot_t(vconcat(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F0)), astuple(TWO, ONE)), canvas(GRAY, UNITY)), R0)))), get_color_rank_f(get_arg_rank_f(astuple(ONE, size_f(sizefilter(colorfilter(rbind(subgrid, I), BLUE), FOUR))), fork(subtract, compose(canvas(BLUE, astuple(ONE, size_f(sizefilter(colorfilter(rbind(subgrid, I), BLUE), FOUR)))), fork(apply, lbind(lbind, colorcount_f), palette_f)), compose(rbind(get_rank, L1), fork(apply, lbind(lbind, colorcount_f), palette_f))), F0), L1)))), rbind(subgrid, I)(mapply(lbind(shift, asobject(mir_rot_t(vconcat(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F0)), astuple(TWO, ONE)), canvas(GRAY, UNITY)), R0))), occurrences(fill(fill(fill(I, CYAN, mapply(lbind(shift, asobject(canvas(GRAY, TWO_BY_TWO))), occurrences(I, asobject(canvas(GRAY, TWO_BY_TWO))))), get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F1)), mapply(lbind(shift, asobject(vconcat(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F0)), astuple(TWO, ONE)), canvas(GRAY, UNITY)))), uppermost_o)), RED, mapply(lbind(shift, asobject(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(first(S)))))()(dedupe(mapply(p_g(apply(second(S)))))()))(F0)), astuple(ONE, THREE)))), occurrences(fill(fill(I, CYAN, mapply(lbind(shift, asobject(canvas(GRAY, TWO_BY_TWO))), occurrences(I, asobject(canvas(GRAY, TWO_BY_TWO))))), get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F1)), mapply(lbind(shift, asobject(vconcat(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F0)), astuple(TWO, ONE)), canvas(GRAY, UNITY)))), uppermost_o)), asobject(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(first(S)))))()(dedupe(mapply(p_g(apply(second(S)))))()))(F0)), astuple(ONE, THREE)))))), asobject(mir_rot_t(vconcat(canvas(get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F0)), astuple(TWO, ONE)), canvas(GRAY, UNITY)), R0))))))