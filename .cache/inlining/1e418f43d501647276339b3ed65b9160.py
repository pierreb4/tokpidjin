def solve(S, I, C):
    return fill(cover(I, merge_f(colorfilter(o_g(I, R5), GRAY))), BLUE, mapply(chain(rbind(extract(remove_f(get_arg_rank_f(palette_t(I), size, L2), palette_t(I)), rbind(adjacent, get_arg_rank_f(palette_t(I), size, L2))), fork(subtract, fork(subtract, fork(subtract, fork(add, chain(rbind(multiply, TEN), size, rbind(intersection, asindices(crop(I, ORIGIN, astuple(FIVE, width_t(I)))))), compose(invert, chain(rbind(multiply, TEN), size, rbind(intersection, mostcolor_t)))), chain(size, rbind(chain, f_ofcolor(crop(I, ORIGIN, astuple(FIVE, width_t(I))), BLACK)), outbox)), compose(rbind(multiply, FIVE), compose(lbind(rbind(get_arg_rank, L1), f_ofcolor(I, get_nth_f(apply(color, difference(o_g(I, R4), sizefilter(o_g(I, R4), ONE))), F0))), compose(lbind(compose, chain(fork(add, mfilter_f(sizefilter(o_g(I, R4), ONE), compose(lbind(contained, THREE), chain(palette_t, trim, center(get_nth_f(sizefilter(o_g(I, R4), ONE), F0))))), fill(replace(I, THREE, MAGENTA), get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F1)), mfilter_f(sizefilter(o_g(I, R4), ONE), compose(lbind(contained, THREE), chain(palette_t, trim, center(get_nth_f(sizefilter(o_g(I, R4), ONE), F0))))))), lbind(apply, fork(multiply, sign, identity)), fork(subtract, mfilter_f(sizefilter(o_g(I, R4), ONE), compose(lbind(contained, THREE), chain(palette_t, trim, center(get_nth_f(sizefilter(o_g(I, R4), ONE), F0))))), compose(center, fill(replace(I, THREE, MAGENTA), get_nth_t(difference_tuple(dedupe(mapply(p_g(apply(second(S)))))()(dedupe(mapply(p_g(apply(first(S)))))()))(F1)), mfilter_f(sizefilter(o_g(I, R4), ONE), compose(lbind(contained, THREE), chain(palette_t, trim, center(get_nth_f(sizefilter(o_g(I, R4), ONE), F0)))))))))), lbind(lbind, astuple))))), chain(size, rbind(chain, f_ofcolor(crop(I, ORIGIN, astuple(FIVE, width_t(I))), BLACK)), delta))), rbind(apply, asindices(crop(I, ORIGIN, astuple(FIVE, width_t(I))))), rbind(get_val_rank, L1)), apply(compose(toindices, normalize), colorfilter(o_g(I, R5), GRAY))))